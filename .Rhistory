Rcpp_o1 = KDEcv_K2B_rcpp_o1(X = X, h = 1)
)
)
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
test1 <- KDEcv_K2B_rcpp(X = X, h = 1)
test2 <- KDEcv_K2B_rcpp_o1(X = X, h = 1)
test3 <- KDEcv_R_kernel(X = X, K = K2_Biweight, h = 1)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDEcv_K2B_rcpp(X = X, h = 1),
Rcpp_o1 = KDEcv_K2B_rcpp_o1(X = X, h = 1),
R_kernel = KDEcv_R_kernel(X = X, K = K2_Biweight, h = 1)
)
)
library(MYHRcpp)
library(MYHRcpp)
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
w <- rexp(n)
test1 <- KDEcv_K2B_w_rcpp(X = X, h = 1, w = w)
test2 <- KDEcv_K2B_w_rcpp_o1(X = X, h = 1, w = w)
sum(abs(test1 - test2))
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
w <- rexp(n)
test1 <- KDEcv_K2B_w_rcpp(X = X, h = 1, w = w)
test2 <- KDEcv_K2B_w_rcpp_o1(X = X, h = 1, w = w)
sum(abs(test1 - test2))
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
w <- rexp(n)
test1 <- KDEcv_K2B_w_rcpp(X = X, h = 1, w = w)
test2 <- KDEcv_K2B_w_rcpp_o1(X = X, h = 1, w = w)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDEcv_K2B_w_rcpp(X = X, h = 1, w = w),
Rcpp_o1 = KDEcv_K2B_w_rcpp_o1(X = X, h = 1, w = w)
)
)
n <- 200
p <- 1
X <- matrix(rnorm(n*p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p))+rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
CP <- function(Y, y)
{
number_n <- dim(Y)[1]
number_k <- dim(y)[1]
Y.CP <- matrix(apply(as.matrix(
Y[rep(1:number_n, times = length(y)), ]<=
y[rep(1:number_k, each = number_n), ]), 1, prod),
nrow = number_n, ncol = number_k)
return(Y.CP)
}
Y.CP <- CP(Y = Y, y = y)
###
Fhat <- NWdist.generic(X = X, Y = Y, x = x, y = y,
K = K2_Biweight, h = 1)
Fhat1 <- NW.generic(X = X, Y = Y.CP, x = x,
K = K2_Biweight, h = 1)
Fhat2 <- NW.generic(X = X, Y = CP(Y = Y, y = y), x = x,
K = K2_Biweight, h = 1)
Fhat_rcpp <- NWF_K2B_rcpp(X = X, Y = Y, x = x, y = y,
h = 1)
Fhat_rcpp1 <- NW_K2B_rcpp(X = X, Y = Y.CP, x = x, h = 1)
Fhat_rcpp2 <- NW_K2B_rcpp(X = X, Y = CP(Y = Y, y = y), x = x, h = 1)
mean((Fhat-Fhat1)^2)
mean((Fhat-Fhat2)^2)
mean((Fhat-Fhat_rcpp)^2)
mean((Fhat-Fhat_rcpp1)^2)
mean((Fhat-Fhat_rcpp2)^2)
ggplot2::autoplot(
microbenchmark::microbenchmark(
outer = NWdist.generic(X = X, Y = Y, x = x, y = y,
K = K2_Biweight, h = 1),
outer1 = NW.generic(X = X, Y = Y.CP, x = x,
K = K2_Biweight, h = 1),
outer2 = NW.generic(X = X, Y = CP(Y = Y, y = y), x = x,
K = K2_Biweight, h = 1),
Rcpp = NWF_K2B_rcpp(X = X, Y = Y, x = x, y = y,
h = 1),
Rcpp1 = NW_K2B_rcpp(X = X, Y = Y.CP, x = x, h = 1),
Rcpp2 = NW_K2B_rcpp(X = X, Y = CP(Y = Y, y = y), x = x, h = 1)
)
)
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1)
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K4B_rcpp(X = X, x = x, h = 1),
Rcpp_o1 = KDE_K4B_rcpp_o1(X = X, x = x, h = 1)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1)
sum(abs(test1 - test2))
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
w <- rexp(n)
test1 <- KDE_K2B_w_rcpp(X = X, x = x, h = 1, w = w)
test2 <- KDE_w_R_kernel(X = X, x = x, K = K2_Biweight, h = 1, w = w)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K2B_w_rcpp(X = X, x = x, h = 1, w = w),
R_kernel = KDE_w_R_kernel(X = X, x = x, K = K2_Biweight, h = 1, w = w)
)
)
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
test1 <- KDEcv_K4B_rcpp(X = X, h = 1)
test2 <- KDEcv_K4B_rcpp_o1(X = X, h = 1)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDEcv_K4B_rcpp(X = X, h = 1),
Rcpp_o1 = KDEcv_K4B_rcpp_o1(X = X, h = 1)
)
)
(700/500)^3.5
test1
(2*pi)^0.5
1/(2*pi)^0.5
1/2.506628
library(MYHRcpp)
####################################################################
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K2B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K2B_rcpp_chatgpt(X = X, x = x, h = 1.5)
test3 <- KDE_rcpp_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
test4 <- KDE_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
hist(X, freq = FALSE)
lines(x, test1)
lines(x, dnorm(x), col = 2)
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K2B_rcpp(X = X, x = x, h = 1.5),
Rcpp_chatgpt = KDE_K2B_rcpp_chatgpt(X = X, x = x, h = 1.5),
Rcpp_kernel = KDE_rcpp_kernel(X = X, x = x, K = K2_Biweight, h = 1.5),
R_kernel = KDE_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
w <- rexp(n)
test1 <- KDE_K2B_w_rcpp(X = X, x = x, h = 1.5, w = w)
test2 <- KDE_w_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5, w = w)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K2B_w_rcpp(X = X, x = x, h = 1.5, w = w),
R_kernel = KDE_w_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5, w = w)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
test1 <- KDEcv_K2B_rcpp(X = X, h = 1.5)
test2 <- KDEcv_K2B_rcpp_o1(X = X, h = 1.5)
test3 <- KDEcv_R_kernel(X = X, K = K2_Biweight, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDEcv_K2B_rcpp(X = X, h = 1.5),
Rcpp_o1 = KDEcv_K2B_rcpp_o1(X = X, h = 1.5),
R_kernel = KDEcv_R_kernel(X = X, K = K2_Biweight, h = 1.5)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
w <- rexp(n)
test1 <- KDEcv_K2B_w_rcpp(X = X, h = 1.5, w = w)
test2 <- KDEcv_K2B_w_rcpp_o1(X = X, h = 1.5, w = w)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDEcv_K2B_w_rcpp(X = X, h = 1.5, w = w),
Rcpp_o1 = KDEcv_K2B_w_rcpp_o1(X = X, h = 1.5, w = w)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K4B_rcpp(X = X, x = x, h = 1.5),
Rcpp_o1 = KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
test1 <- KDEcv_K4B_rcpp(X = X, h = 1.5)
test2 <- KDEcv_K4B_rcpp_o1(X = X, h = 1.5)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDEcv_K4B_rcpp(X = X, h = 1.5),
Rcpp_o1 = KDEcv_K4B_rcpp_o1(X = X, h = 1.5)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K4B_rcpp(X = X, x = x, h = 1.5),
Rcpp_o1 = KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
)
)
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K4B_rcpp(X = X, x = x, h = 1),
Rcpp_o1 = KDE_K4B_rcpp_o1(X = X, x = x, h = 1)
)
)
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K4B_rcpp(X = X, x = x, h = 1.5),
Rcpp_o1 = KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
)
)
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
Rcpp = KDE_K4B_rcpp(X = X, x = x, h = 1.5),
Rcpp_o1 = KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
)
)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
sum(abs(test1 - test2))
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K2B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K2B_rcpp_chatgpt(X = X, x = x, h = 1.5)
test3 <- KDE_rcpp_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
test4 <- KDE_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
hist(X, freq = FALSE)
lines(x, test1)
lines(x, dnorm(x), col = 2)
test1 <- KDE_K2B_rcpp(X = X, x = x, h = 0.5)
lines(x, test1, lty = 2)
test1 <- KDE_K2B_rcpp(X = X, x = x, h = 0.1)
lines(x, test1, lty = 3)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K2B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K2B_rcpp_chatgpt(X = X, x = x, h = 1.5)
test3 <- KDE_rcpp_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
test4 <- KDE_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
w <- rexp(n)
test1 <- KDE_K2B_w_rcpp(X = X, x = x, h = 1.5, w = w)
test2 <- KDE_w_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5, w = w)
sum(abs(test1 - test2))
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
test1 <- KDEcv_K2B_rcpp(X = X, h = 1.5)
test2 <- KDEcv_K2B_rcpp_o1(X = X, h = 1.5)
test3 <- KDEcv_R_kernel(X = X, K = K2_Biweight, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
w <- rexp(n)
test1 <- KDEcv_K2B_w_rcpp(X = X, h = 1.5, w = w)
test2 <- KDEcv_K2B_w_rcpp_o1(X = X, h = 1.5, w = w)
sum(abs(test1 - test2))
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K4B_rcpp_o1(X = X, x = x, h = 1.5)
sum(abs(test1 - test2))
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
test1 <- KDEcv_K4B_rcpp(X = X, h = 1.5)
test2 <- KDEcv_K4B_rcpp_o1(X = X, h = 1.5)
sum(abs(test1 - test2))
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- KDE_K2B_rcpp(X = X, x = x, h = 1.5)
test2 <- KDE_K2B_rcpp_chatgpt(X = X, x = x, h = 1.5)
test3 <- KDE_rcpp_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
test4 <- KDE_R_kernel(X = X, x = x, K = K2_Biweight, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
hist(X, freq = FALSE)
lines(x, test1)
lines(x, dnorm(x), col = 2)
test <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
lines(x, test1, lty = 2)
test <- KDE_K4B_rcpp(X = X, x = x, h = 1.5)
lines(x, test, lty = 2)
test <- KDE_KG_rcpp(X = X, x = x, h = 1.5)
lines(x, test, lty = 3)
test <- KDE_KG_rcpp(X = X, x = x, h = 0.5)
lines(x, test, lty = 3)
test <- KDE_KG_rcpp(X = X, x = x, h = 0.1)
lines(x, test, lty = 3)
library(MYHRcpp)
library(MYHRcpp)
library(MYHRcpp)
library(MYHRcpp)
n <- 1000
p <- 10
A <- matrix(rnorm(n*p), n, p)
test1 <- eXsq_rcpp(A)
test2 <- eXsq_R(A)
library(MYHRcpp)
n <- 1000
p <- 10
A <- matrix(rnorm(n*p), n, p)
test1 <- eXsq_rcpp(A)
test2 <- eXsq_R(A)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = eXsq_R(A),
Rcpp = eXsq_rcpp(A)
)
)
library(MYHRcpp)
n <- 1000
p <- 10
A <- matrix(rnorm(n*p), n, p)
w <- rexp(n)
test1 <- eXsq_w_rcpp(A, w)
test2 <- eXsq_w_R(A, w)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = eXsq_w_R(A, w),
Rcpp = eXsq_w_rcpp(A, w)
)
)
?lower.tri
lower.tri(matrix(1:9, 3, 3))
library(MYHRcpp)
number_p <- 5
A <- matrix(1:(number_p ^ 2), number_p, number_p)
index.lowtri <- A[lower.tri(A)]
index.lowtri
library(MYHRcpp)
n <- 1000
p <- 10
A <- matrix(rnorm(n*p), n, p)
test1 <- Xsq_lowtri_rcpp(A)
test2 <- Xsq_lowtri_R(A)
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = Xsq_lowtri_R(A),
Rcpp = Xsq_lowtri_rcpp(A)
)
)
library(MYHRcpp)
n <- 1000
p <- 10
k <- 50
Y <- matrix(rnorm(n*p), n, p)
y <- matrix(rnorm(k*p), k, p)
test1 <- ctingP_R(Y, y)
dim(test1)
library(MYHRcpp)
n <- 1000
p <- 10
k <- 50
Y <- matrix(rnorm(n*p), n, p)
y <- matrix(rnorm(k*p), k, p)
test1 <- ctingP_R(Y, y)
mean(test1)
sum(test1)
?matrix
library(MYHRcpp)
n <- 1000
p <- 1
k <- 50
Y <- matrix(rnorm(n*p), n, p)
y <- matrix(rnorm(k*p), k, p)
test1 <- ctingP_R(Y, y)
test2 <- ctingP_uni_R(as.vector(Y), as.vector(y))
sum(abs(test1 - test2))
sum(test1)
sum(test2)
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = ctingP_R(Y, y),
R_uni = ctingP_uni_R(as.vector(Y), as.vector(y))
)
)
n <- 1000
p <- 1
k <- 50
Y <- matrix(rnorm(n*p), n, p)
y <- matrix(rnorm(k*p), k, p)
test1 <- ctingP_R(Y, y)
test2 <- ctingP_uni_R(as.vector(Y), as.vector(y))
sum(abs(test1 - test2))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = ctingP_R(Y, y),
R_uni = ctingP_uni_R(as.vector(Y), as.vector(y))
)
)
library(MYHRcpp)
n <- 1000
p <- 1
k <- 50
Y <- matrix(rnorm(n*p), n, p)
y <- matrix(rnorm(k*p), k, p)
test1 <- ctingP_R(Y, y)
test2 <- ctingP_uni_R(as.vector(Y), as.vector(y))
test3 <- ctingP_rcpp(Y, y)
test4 <- ctingP_uni_rcpp(as.vector(Y), as.vector(y))
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = ctingP_R(Y, y),
R_uni = ctingP_uni_R(as.vector(Y), as.vector(y)),
Rcpp = ctingP_rcpp(Y, y),
Rcpp_uni = ctingP_uni_rcpp(as.vector(Y), as.vector(y))
)
)
