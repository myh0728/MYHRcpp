x = x, h = 1.5)
test10 <- NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
sum(abs(test1 - test5))
sum(abs(test1 - test6))
sum(abs(test1 - test7))
sum(abs(test1 - test8))
sum(abs(test1 - test9))
sum(abs(test1 - test10))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
R_uni = NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5),
Rcpp = NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_u1 = NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_v0 = NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_v1 = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5),
R_v0 = NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5),
R_v1 = NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5),
Rcpp_n0 = NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_n1 = NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
library(MYHRcpp)
if (1>1){
a <- 1
}
else if (1>0){
if (1>1){
a <- 1
}else if (1>0){
a <- 2
}else{
a <- 3
}
a
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
hhat <- LOOCV(X = X, Y = Y)
hhat
hhat1 <- LOOCV(X = X, Y = Y, regression = "mean")
hhat1
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
### selecting bandwidth using leave-one-out cross-validation
hhat <- LOOCV(X = X, Y = Y)
hhat
hhat1 <- LOOCV(X = X, Y = Y, regression = "mean")
hhat1
hhat2 <- LOOCV(X = X, Y = Y, regression = "distribution")
hhat2
library(MYHRcpp)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
X <- as.matrix(X)
Y <- as.matrix(Y)
number_n <- dim(X)[1]
number_p <- dim(X)[2]
(dim(Y)[2] == 1)
Y.CP <- ctingP_uni_rcpp(as.vector(Y), as.vector(Y))
dim(Y.CP)
cv.h <- function(h.log)
{
cv <- sum((Y.CP - NWcv_K2B_rcpp(
X = X, Y = Y.CP, h = rep(exp(h.log), number_p)
)) ^ 2)
return(cv)
}
cv.h(0)
test <- NWcv_K2B_rcpp(
X = X, Y = Y.CP, h = rep(exp(0), number_p)
)
NWcv_K2B_rcpp
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
test1 <- NWcv_R_kernel(X = X, Y = Y, K = K2_Biweight, h = 1.5)
test2 <- NWcv_K2B_rcpp(X = X, Y = Y, h = 1.5)
test3 <- NWcv_K2B_rcpp_o1(X = X, Y = Y, h = 1.5)
test4 <- NWcv_K2B_rcpp_o2(X = X, Y = Y, h = 1.5)
test5 <- NWcv_K2B_rcpp_o3(X = X, Y = Y, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
sum(abs(test1 - test5))
library(MYHRcpp)
n <- 100
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
test1 <- NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5)
test2 <- NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5)
test3 <- NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5)
test4 <- NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test5 <- NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test6 <- NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5)
test7 <- NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5)
test8 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test9 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test10 <- NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
sum(abs(test1 - test5))
sum(abs(test1 - test6))
sum(abs(test1 - test7))
sum(abs(test1 - test8))
sum(abs(test1 - test9))
sum(abs(test1 - test10))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
R_uni = NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5),
Rcpp = NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_u1 = NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_v0 = NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_v1 = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5),
R_v0 = NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5),
R_v1 = NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5),
Rcpp_n0 = NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_n1 = NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
library(MYHRcpp)
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
R_uni = NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5),
Rcpp = NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_u1 = NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_v0 = NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_v1 = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5),
R_v0 = NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5),
R_v1 = NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5),
Rcpp_n0 = NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_n1 = NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
library(MYHRcpp)
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
R_uni = NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5),
Rcpp = NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_u1 = NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_v0 = NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_v1 = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5),
R_v0 = NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5),
R_v1 = NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5),
Rcpp_n0 = NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_n1 = NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
n <- 200
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
test1 <- NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5)
test2 <- NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5)
test3 <- NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5)
test4 <- NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test5 <- NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test6 <- NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5)
test7 <- NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5)
test8 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test9 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test10 <- NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
sum(abs(test1 - test5))
sum(abs(test1 - test6))
sum(abs(test1 - test7))
sum(abs(test1 - test8))
sum(abs(test1 - test9))
sum(abs(test1 - test10))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
R_uni = NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5),
Rcpp = NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_u1 = NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_v0 = NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_v1 = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5),
R_v0 = NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5),
R_v1 = NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5),
Rcpp_n0 = NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_n1 = NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
n <- 500
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
test1 <- NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5)
test2 <- NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5)
test3 <- NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5)
test4 <- NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test5 <- NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test6 <- NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5)
test7 <- NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5)
test8 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test9 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test10 <- NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
sum(abs(test1 - test5))
sum(abs(test1 - test6))
sum(abs(test1 - test7))
sum(abs(test1 - test8))
sum(abs(test1 - test9))
sum(abs(test1 - test10))
ggplot2::autoplot(
microbenchmark::microbenchmark(
R = NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
R_uni = NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5),
Rcpp = NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_u1 = NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5),
Rcpp_v0 = NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_v1 = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5),
R_v0 = NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5),
R_v1 = NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5),
Rcpp_n0 = NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5),
Rcpp_n1 = NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
library(MYHRcpp)
n <- 500
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
ggplot2::autoplot(
microbenchmark::microbenchmark(
mean = NW_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5),
dist = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
ggplot2::autoplot(
microbenchmark::microbenchmark(
mean = NW_R_kernel(X = X, Y = Y, x = x, K = K2_Biweight, h = 1.5),
dist = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
ggplot2::autoplot(
microbenchmark::microbenchmark(
mean = NW_K2B_rcpp(X = X, Y = Y, x = x, h = 1.5),
dist = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
)
microbenchmark::microbenchmark(
mean = NW_K2B_rcpp(X = X, Y = Y, x = x, h = 1.5),
dist = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
microbenchmark::microbenchmark(
mean = NW_K2B_rcpp(X = X, Y = Y, x = x, h = 1.5),
dist = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
)
4.149599/1.752656
library(MYHRcpp)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
test1 <- DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
h = 1.5)
microbenchmark::microbenchmark(
mean = sum((Y - NWcv_K2B_rcpp(X = X, Y = Y, h = rep(h, p))) ^ 2),
dist = DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
h = 1.5)
)
microbenchmark::microbenchmark(
mean = sum((Y - NWcv_K2B_rcpp(X = X, Y = Y, h = rep(1.5, p))) ^ 2),
dist = DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
h = 1.5)
)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
microbenchmark::microbenchmark(
mean = sum((Y - NWcv_K2B_rcpp(X = X, Y = Y, h = rep(1.5, p))) ^ 2),
dist = DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
h = 1.5)
)
exp(-1)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
### selecting bandwidth using leave-one-out cross-validation
hhat <- LOOCV(X = X, Y = Y)
hhat1 <- LOOCV(X = X, Y = Y, regression = "mean")
hhat2 <- LOOCV(X = X, Y = Y, regression = "distribution")
hhat2
hhat1
X <- as.matrix(X)
Y <- as.matrix(Y)
number_n <- dim(X)[1]
number_p <- dim(X)[2]
dim(Y)[2] == 1
Y.CP <- ctingP_uni_rcpp(as.vector(Y), as.vector(Y))
dim(Y.CP)
cv.h <- function(h.log)
{
cv <- sum((Y.CP - NWcv_K2B_rcpp(
X = X, Y = Y.CP, h = rep(exp(h.log), number_p)
)) ^ 2)
return(cv)
}
cv.h(0)
cv.h(0)/1000/1000
cv.h(-1)/1000/1000
test <- NWcv_K2B_rcpp(X = X, Y = Y.CP, h = rep(exp(0), p))
dim(test)
test <- NW_K2B_rcpp(X = X, Y = Y.CP, h = rep(exp(0), p))
test <- NW_K2B_rcpp(X = X, Y = Y.CP, x = X, h = rep(exp(0), p))
microbenchmark::microbenchmark(
cv = NWcv_K2B_rcpp(X = X, Y = Y.CP, h = rep(exp(0), p)),
no = NW_K2B_rcpp(X = X, Y = Y.CP, h = rep(exp(0), p))
)
microbenchmark::microbenchmark(
cv = NWcv_K2B_rcpp(X = X, Y = Y.CP, h = rep(exp(0), p)),
no = NW_K2B_rcpp(X = X, Y = Y.CP, x = X, h = rep(exp(0), p))
)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
test1 <- NW_R_kernel(X = X, Y = Y, x = x, K = K2_Biweight, h = 1.5)
test2 <- NW_K2B_rcpp(X = X, Y = Y, x = x, h = 1.5)
test2 <- NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(Y)), x = x, h = 1.5)
microbenchmark::microbenchmark(
test = NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(Y)), x = x, h = 1.5)
)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
test1 <- DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
h = 1.5)
test2 <- DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
h = rep(1.5, p))
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
dim(X)
dim(Y)
####################################################################
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 50))
test1 <- DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(Y)),
h = 1.5)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 1000))
test1 <- NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5)
library(MYHRcpp)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.1))
y <- as.matrix(seq(min(Y), max(Y), length = 1000))
test1 <- NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5)
test2 <- NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5)
test3 <- NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5)
test4 <- NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
dim(test1)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
x <- as.matrix(seq(-3, 3, 0.01))
y <- as.matrix(seq(min(Y), max(Y), length = 1000))
test1 <- NWD_R_kernel(X = X, Y = Y, x = x, y = y, K = K2_Biweight, h = 1.5)
test2 <- NWD_uni_R_kernel(X = X, Y = as.vector(Y), x = x, y = as.vector(y),
K = K2_Biweight, h = 1.5)
test3 <- NWD_K2B_rcpp(X = X, Y = Y, x = x, y = y, h = 1.5)
test4 <- NW_K2B_rcpp(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test5 <- NW_K2B_rcpp(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test6 <- NW_R_kernel(X = X, Y = ctingP_rcpp(Y, y), x = x, K = K2_Biweight, h = 1.5)
test7 <- NW_R_kernel(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, K = K2_Biweight, h = 1.5)
test8 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_rcpp(Y, y), x = x, h = 1.5)
test9 <- NW_K2B_rcpp_n1(X = X, Y = ctingP_uni_rcpp(as.vector(Y), as.vector(y)),
x = x, h = 1.5)
test10 <- NWD_K2B_rcpp_u1(X = X, Y = Y, x = x, y = y, h = 1.5)
sum(abs(test1 - test2))
sum(abs(test1 - test3))
sum(abs(test1 - test4))
sum(abs(test1 - test5))
sum(abs(test1 - test6))
sum(abs(test1 - test7))
sum(abs(test1 - test8))
sum(abs(test1 - test9))
sum(abs(test1 - test10))
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
test1 <- DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(Y)),
h = 1.5)
library(MYHRcpp)
n <- 1000
p <- 1
X <- matrix(rnorm(n * p), nrow = n, ncol = p)
Y <- as.matrix(sin(X %*% rep(1, p)) + rnorm(n, mean = 0, sd = 0.2))
test1 <- DRCV_K2B_R(X = X,
Y.CP = ctingP_uni_rcpp(as.vector(Y), as.vector(Y)),
h = 1.5)
dim(test2)
dim(test2)
dim(test1)
test2
test1
sum((Y - NWcv_K2B_rcpp(X = X, Y = Y, h = rep(1.5, p))) ^ 2)
